---
title: Protocol Buffers API
---

<!-- This file is generated. Please edit the .proto files instead to update the documentation -->

The API is divided into the [read API](/TODO) and [write API](/TODO).
Each service is annotated with the API it belongs to.


  

## ory/keto/acl/v1alpha1/acl.proto


  

  

### RelationTuple
RelationTuple relates an Object with a Subject.

While a tuple reflects a relationship between Object
and Subject, they do not completely define the effective ACLs.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | namespace | [string](#string) |  | The namespace this relation tuple lives in. |
      | object | [string](#string) |  | The object related by this tuple. It is naturally in the namespace of the tuple. |
      | relation | [string](#string) |  | The relation between an Object and a Subject. |
      | subject | [Subject](#ory.keto.acl.v1alpha1.Subject) |  | The subject related by this tuple. A Subject either represents a concrete subject id or a SubjectSet that expands to more Subjects. |
      
    

    

  

### Subject
Subject is either a concrete subject id or
a subject set expanding to more Subjects.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | id | [string](#string) |  | A concrete id of the subject. |
      | set | [SubjectSet](#ory.keto.acl.v1alpha1.SubjectSet) |  | A subject set that expands to more Subjects (used for inheritance). |
      
    

    

  

### SubjectSet
SubjectSet refers to all subjects which have
the same `relation` to an `object`.
It is also used for inheritance.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | namespace | [string](#string) |  | The namespace of the object and relation referenced in this subject set. |
      | object | [string](#string) |  | The object selected by the subjects. |
      | relation | [string](#string) |  | The relation to the object by the subjects. |
      
    

    

  

  

  


  

## ory/keto/acl/v1alpha1/check_service.proto


  

### CheckService
The service that performs authorization checks
based on the stored Access Control Lists.

| Method Name | Request Type | Response Type | Description |
| ----------- | ------------ | ------------- | ------------|
    | Check | [CheckRequest](#ory.keto.acl.v1alpha1.CheckRequest) | [CheckResponse](#ory.keto.acl.v1alpha1.CheckResponse) | Check performs an authorization check. |
    
  

  

### CheckRequest
The request for a CheckService.Check rpc.
Checks whether a specific subject is related to an object.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | namespace | [string](#string) |  | The namespace to evaluate the check.<br/>Note: If you use the expand API and the check evaluates a RelationTuple specifying a SubjectSet as subject or due to a rewrite rule in a namespace config this check request may involve other namespaces automatically. |
      | object | [string](#string) |  | The related object in this check. |
      | relation | [string](#string) |  | The relation between the Object and the Subject. |
      | subject | [Subject](#ory.keto.acl.v1alpha1.Subject) |  | The related subject to check against. |
      | latest | [bool](#bool) |  | Set this field to `true` in case your application needs to authorize depending on up to date ACLs, also called a "content-change check".<br/>If set to `true` the `snaptoken` field is ignored, the check is evaluated at the latest snapshot (globally consistent) and the response includes a snaptoken for clients to store along with object contents that can be used for subsequent checks of the same content version.<br/>Example use case: - You need to authorize a user to modify/delete some resource and it is unacceptable that if the permission to do that had just been revoked some seconds ago so that the change had not yet been fully replicated to all availability zones. |
      | snaptoken | [string](#string) |  | Optional. Like reads, a check is always evaluated at a consistent snapshot no earlier than the given snaptoken.<br/>Leave this field blank if you want to evaluate the check based on eventually consistent ACLs, benefiting from very low latency, but possibly slightly stale results.<br/>If the specified token is too old and no longer known, the server falls back as if no snaptoken had been specified.<br/>If not specified the server tries to evaluate the check on the best snapshot version where it is very likely that ACLs had already been replicated to all availability zones. |
      
    

    

  

### CheckResponse
The response for a CheckService.Check rpc.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | allowed | [bool](#bool) |  | Whether the specified subject (id) is related to the requested object.<br/>It is false by default if no ACL matches. |
      | snaptoken | [string](#string) |  | The last known snapshot token ONLY specified if the request had not specified a snaptoken, since this performed a "content-change request" and consistently fetched the last known snapshot token.<br/>This field is not set if the request had specified a snaptoken!<br/>If set, clients should cache and use this token for subsequent requests to have minimal latency, but allow slightly stale responses (only some milliseconds or seconds). |
      
    

    

  

  

  


  

## ory/keto/acl/v1alpha1/expand_service.proto


  

### ExpandService
The service that performs subject set expansion
based on the stored Access Control Lists.

| Method Name | Request Type | Response Type | Description |
| ----------- | ------------ | ------------- | ------------|
    | Expand | [ExpandRequest](#ory.keto.acl.v1alpha1.ExpandRequest) | [ExpandResponse](#ory.keto.acl.v1alpha1.ExpandResponse) | Expands the subject set into a tree of subjects. |
    
  

  

### ExpandRequest
The request for a ExpandService.Expand rpc.
Expands the given subject set.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | subject | [Subject](#ory.keto.acl.v1alpha1.Subject) |  | The subject to expand. |
      | max_depth | [int32](#int32) |  | The maximum depth of tree to build. |
      | snaptoken | [string](#string) |  | Optional. Like reads, a expand is always evaluated at a consistent snapshot no earlier than the given snaptoken.<br/>Leave this field blank if you want to expand based on eventually consistent ACLs, benefiting from very low latency, but possibly slightly stale results.<br/>If the specified token is too old and no longer known, the server falls back as if no snaptoken had been specified.<br/>If not specified the server tries to build the tree on the best snapshot version where it is very likely that ACLs had already been replicated to all availability zones. |
      
    

    

  

### ExpandResponse
The response for a ExpandService.Expand rpc.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | tree | [SubjectTree](#ory.keto.acl.v1alpha1.SubjectTree) |  | The tree the requested subject set expands to. The requested subject set is the subject of the root. |
      
    

    

  

### SubjectTree


    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | node_type | [NodeType](#ory.keto.acl.v1alpha1.NodeType) |  | The type of the node. |
      | subject | [Subject](#ory.keto.acl.v1alpha1.Subject) |  | The subject this node represents. |
      | children | [SubjectTree](#ory.keto.acl.v1alpha1.SubjectTree) | repeated | The children of this node; not given if node_type == Leaf. |
      
    

    

  

  

### NodeType


| Name | Number | Description |
| ---- | ------ | ----------- |
    | NODE_TYPE_UNSPECIFIED | 0 |  |
    | NODE_TYPE_UNION | 1 | This node expands to a union of all children. |
    | NODE_TYPE_EXCLUSION | 2 | Not implemented yet. |
    | NODE_TYPE_INTERSECTION | 3 | Not implemented yet. |
    | NODE_TYPE_LEAF | 4 | This node is a leaf and contains no children. Its subject is a SubjectID unless max_depth was reached. |
    

  

  


  

## ory/keto/acl/v1alpha1/read_service.proto


  

### ReadService
The service to query Access Control Lists.

| Method Name | Request Type | Response Type | Description |
| ----------- | ------------ | ------------- | ------------|
    | ListRelationTuples | [ListRelationTuplesRequest](#ory.keto.acl.v1alpha1.ListRelationTuplesRequest) | [ListRelationTuplesResponse](#ory.keto.acl.v1alpha1.ListRelationTuplesResponse) | Lists ACL relation tuples. |
    
  

  

### ListRelationTuplesRequest
Request for ReadService.ListRelationTuples rpc.
See ListRelationTuplesRequest_Query for more querying details.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | query | [ListRelationTuplesRequest.Query](#ory.keto.acl.v1alpha1.ListRelationTuplesRequest.Query) |  | All field constraints are concatenated with a logical AND operator.<br/>The RelationTuple list from ListRelationTuplesResponse is ordered from the newest RelationTuple to the oldest. |
      | expand_mask | [google.protobuf.FieldMask](#google.protobuf.FieldMask) |  | Optional. The list of fields to be expanded in the RelationTuple list returned in `ListRelationTuplesResponse`. Leaving this field unspecified means all fields are expanded.<br/>Available fields: "object", "relation", "subject", "namespace", "subject.id", "subject.namespace", "subject.object", "subject.relation" |
      | snaptoken | [string](#string) |  | Optional. The snapshot token for this read. |
      | page_size | [int32](#int32) |  | Optional. The maximum number of RelationTuples to return in the response. |
      | page_token | [string](#string) |  | Optional. A pagination token returned from a previous call to `ListRelationTuples` that indicates where the page should start at. |
      
    

    

  

### ListRelationTuplesRequest.Query
The query for listing relation tuples.
Clients can specify any optional field to
partially filter for specific relation tuples.

Example use cases:
 - object only: display a list of all rules of one object
 - relation only: get all groups that have members; e.g. get all directories that have content
 - object & relation: display all subjects that have e.g. write relation
 - subject & relation: display all groups a subject belongs to/display all objects a subject has access to
 - object & relation & subject: check whether the relation tuple already exists, before writing it

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | namespace | [string](#string) |  | Required. The namespace to query. |
      | object | [string](#string) |  | Optional. |
      | relation | [string](#string) |  | Optional. |
      | subject | [Subject](#ory.keto.acl.v1alpha1.Subject) |  | Optional. |
      
    

    

  

### ListRelationTuplesResponse
The response of a ReadService.ListRelationTuples rpc.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | relation_tuples | [RelationTuple](#ory.keto.acl.v1alpha1.RelationTuple) | repeated | The relation tuples matching the list request. |
      | next_page_token | [string](#string) |  | The token required to get the next page. |
      | is_last_page | [bool](#bool) |  | Whether this is the last page. Using the next_page_token in a subsequent request if is_last_page is true will return an error. |
      
    

    

  

  

  


  

## ory/keto/acl/v1alpha1/version.proto


  

### VersionService


| Method Name | Request Type | Response Type | Description |
| ----------- | ------------ | ------------- | ------------|
    | GetVersion | [GetVersionRequest](#ory.keto.acl.v1alpha1.GetVersionRequest) | [GetVersionResponse](#ory.keto.acl.v1alpha1.GetVersionResponse) |  |
    
  

  

### GetVersionRequest


    

    

  

### GetVersionResponse


    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | version | [string](#string) |  |  |
      
    

    

  

  

  


  

## ory/keto/acl/v1alpha1/write_service.proto


  

### WriteService
The write service to create and delete Access Control Lists.

| Method Name | Request Type | Response Type | Description |
| ----------- | ------------ | ------------- | ------------|
    | TransactRelationTuples | [TransactRelationTuplesRequest](#ory.keto.acl.v1alpha1.TransactRelationTuplesRequest) | [TransactRelationTuplesResponse](#ory.keto.acl.v1alpha1.TransactRelationTuplesResponse) | Writes one or more relation tuples in a single transaction. |
    
  

  

### RelationTupleDelta
Write-delta for a TransactRelationTuplesRequest.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | action | [RelationTupleDelta.Action](#ory.keto.acl.v1alpha1.RelationTupleDelta.Action) |  | The action to do on the RelationTuple. |
      | relation_tuple | [RelationTuple](#ory.keto.acl.v1alpha1.RelationTuple) |  | The target RelationTuple. |
      
    

    

  

### TransactRelationTuplesRequest
The request of a WriteService.TransactRelationTuples rpc.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | relation_tuple_deltas | [RelationTupleDelta](#ory.keto.acl.v1alpha1.RelationTupleDelta) | repeated | The write delta for the relation tuples operated in one single transaction. Either all actions commit or no change takes effect on error.<br/>The tuple's etag is used for a consistent read-modify-write request flow. If the etag is not present, the tuple is not validated against the state of the serverside tuple and get operated anyway. |
      
    

    

  

### TransactRelationTuplesResponse
The response of a WriteService.TransactRelationTuples rpc.

    
| Field | Type | Label | Description |
| ----- | ---- | ----- | ----------- |
      | snaptokens | [string](#string) | repeated | The list of the new latest snapshot tokens of the affected RelationTuple, with the same index as specified in the `relation_tuple_deltas` field of the TransactRelationTuplesRequest request.<br/>If the RelationTupleDelta_Action was DELETE the snaptoken is empty at the same index. |
      
    

    

  

  

### RelationTupleDelta.Action


| Name | Number | Description |
| ---- | ------ | ----------- |
    | ACTION_UNSPECIFIED | 0 | Unspecified. The `TransactRelationTuples` rpc ignores this RelationTupleDelta if an action was unspecified. |
    | INSERT | 1 | Insertion of a new RelationTuple. It is ignored if already existing. |
    | DELETE | 4 | Deletion of the RelationTuple. It is ignored if it does not exist. |
    

  

  



## Scalar Value Types

| .proto Type | Notes | C++ | Java | Python | Go | C# | PHP | Ruby |
| ----------- | ----- | --- | ---- | ------ | -- | -- | --- | ---- |
| <a id="double" ></a> double |  | double | double | float | float64 | double | float | Float |
| <a id="float" ></a> float |  | float | float | float | float32 | float | float | Float |
| <a id="int32" ></a> int32 | Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint32 instead. | int32 | int | int | int32 | int | integer | Bignum or Fixnum (as required) |
| <a id="int64" ></a> int64 | Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint64 instead. | int64 | long | int/long | int64 | long | integer/string | Bignum |
| <a id="uint32" ></a> uint32 | Uses variable-length encoding. | uint32 | int | int/long | uint32 | uint | integer | Bignum or Fixnum (as required) |
| <a id="uint64" ></a> uint64 | Uses variable-length encoding. | uint64 | long | int/long | uint64 | ulong | integer/string | Bignum or Fixnum (as required) |
| <a id="sint32" ></a> sint32 | Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int32s. | int32 | int | int | int32 | int | integer | Bignum or Fixnum (as required) |
| <a id="sint64" ></a> sint64 | Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int64s. | int64 | long | int/long | int64 | long | integer/string | Bignum |
| <a id="fixed32" ></a> fixed32 | Always four bytes. More efficient than uint32 if values are often greater than 2^28. | uint32 | int | int | uint32 | uint | integer | Bignum or Fixnum (as required) |
| <a id="fixed64" ></a> fixed64 | Always eight bytes. More efficient than uint64 if values are often greater than 2^56. | uint64 | long | int/long | uint64 | ulong | integer/string | Bignum |
| <a id="sfixed32" ></a> sfixed32 | Always four bytes. | int32 | int | int | int32 | int | integer | Bignum or Fixnum (as required) |
| <a id="sfixed64" ></a> sfixed64 | Always eight bytes. | int64 | long | int/long | int64 | long | integer/string | Bignum |
| <a id="bool" ></a> bool |  | bool | boolean | boolean | bool | bool | boolean | TrueClass/FalseClass |
| <a id="string" ></a> string | A string must always contain UTF-8 encoded or 7-bit ASCII text. | string | String | str/unicode | string | string | string | String (UTF-8) |
| <a id="bytes" ></a> bytes | May contain any arbitrary sequence of bytes. | string | ByteString | str | []byte | ByteString | string | String (ASCII-8BIT) |

